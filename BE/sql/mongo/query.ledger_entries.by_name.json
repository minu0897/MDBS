[
  {
    "$lookup": {
      "from": "accounts",
      "let": { "ledger_account_id": "$account_id" },
      "pipeline": [
        {
          "$match": {
            "name": {{name}},
            "$expr": {
              "$eq": ["$_id", "$$ledger_account_id"]
            }
          }
        }
      ],
      "as": "account_match"
    }
  },
  {
    "$match": {
      "account_match": { "$ne": [] }
    }
  },
  {
    "$sort": {
      "_id": 1
    }
  },
  {
    "$project": {
      "entry_id": { "$toString": "$_id" },
      "txn_id": 1,
      "account_id": 1,
      "amount": 1,
      "created_at": 1
    }
  }
]
